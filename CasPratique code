# ProjectÂ : Explore birthrates in the USA between 2000 and 2014
#################################
## 1. Introduction to the dataset

# Preview of the first 10 lines of the "US_births_2000-2014.csv" file.
data = open("US_births_2000-2014.csv", "r", encoding="utf-8").read()
births_split = data.split("\n")
print(births_split[:10])

# Create a function read_csv() that returns a list of integers representing each data.
def read_csv(file):
    f = open(file, "r", encoding="utf-8")
    string_list = f.read()
    string_list = string_list.split('\n')
    string_list = string_list[1:]  #remove the headline
    
    final_list = []
    for item in string_list:
        int_fields = []
        int_data = item.split(",") #get year, month, date of month, day of the week, amount of births
    
        for item in int_data:
            int_fields.append(int(item))
        final_list.append(int_fields)

    return (final_list)

us_births_list = read_csv("US_births_2000-2014.csv")
print (us_births_list[:10])

###############################
## 2. Calculate the amount of births for each month

# Create a function month_births() that returns a dictionary that contains amount of births for each month.

# REMINDER:
# each_line[1] = month
# each_line[4] = amount of births

def month_births(us_births_list):
    us_months_births = {}
    
    for each_line in us_births_list:
        if each_line[1] in us_months_births:
            nb_births = int(each_line[4]) 
            us_months_births[each_line[1]] += nb_births
        else: 
            us_months_births[each_line[1]] = 0
    return us_months_births

month_births_list = month_births(us_births_list)
print (month_births_list)

###############################
## 3. Calculate the amount of births for each day of the week

# Create a function month_births() that returns a dictionary that contains amount of births for each month.

# REMINDER:
# each_line[3] = day in the week
# each_line[4] = amount of births

def day_births(list):
    days_of_week = {}
    
    for each_line in list:
        day = each_line[3]
        birth = each_line[4]
        
        if day in days_of_week:
            days_of_week[day] += birth
        else: 
            days_of_week[day] = birth
        
    return (days_of_week)

us_days_births = day_births(us_births_list)
print (us_days_births)

###############################
## 4. A more global approach with _calc_count()_

# Filter on any column.
##> Accordingly to the column-number entered **(ie 0 = year, 1 = month, 2 = date in the month, 3 = day in the week)**, the function returns the corresponding amount of births.<br>Result assigned to the dictionary _total_births{}_
##>> Example: _calc_counts(us_births_list, 2)_ will return the amount of birth for each day of the month.

# Filter the max value from it.

# REMINDER:
# each_line[0] = year
# each_line[1] = month
# each_line[2] = date in the month
# each_line[3] = day in the week
# each_line[4] = amount of births

def calc_counts(list, column):
    total_births = {}  
    
    for elem in list:
        data_in_column = elem[column] # Filter on any column
        births = elem[4]
        if data_in_column in total_births:
            total_births[data_in_column] += births
        else:
            total_births[data_in_column] = births
            
    max_amount = max(total_births.items(), key = lambda x: x[1]) # Filter the max value from it       
    result = "Total births:\xa0\n" +  str(total_births) + "\nMax:\xa0\n" +  str(max_amount)
    return (result)
    
### Result per YEAR
us_year_births = calc_counts(us_births_list, 0)
print (us_year_births)
 
### Result per MONTH
us_month_births = calc_counts(us_births_list, 1)
print (us_month_births)
 
### Result per DATE OF THE MONTH
us_day_month_births = calc_counts(us_births_list, 2)
print (us_day_month_births)

### Result per DAY OF THE WEEK
us_day_week_births = calc_counts(us_births_list, 3)
print (us_day_week_births)
 
    
    
    
